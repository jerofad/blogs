<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Title | Jeremiah O. Fadugba</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="summary" />
<meta property="og:description" content="summary" />
<link rel="canonical" href="https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html" />
<meta property="og:url" content="https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html" />
<meta property="og:site_name" content="Jeremiah O. Fadugba" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-12T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-03-12T00:00:00-05:00","dateModified":"2020-03-12T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html"},"description":"summary","@type":"BlogPosting","url":"https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html","headline":"Title","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blogs/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jerofad.github.io/blogs/feed.xml" title="Jeremiah O. Fadugba" /><link rel="shortcut icon" type="image/x-icon" href="/blogs/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Title | Jeremiah O. Fadugba</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="summary" />
<meta property="og:description" content="summary" />
<link rel="canonical" href="https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html" />
<meta property="og:url" content="https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html" />
<meta property="og:site_name" content="Jeremiah O. Fadugba" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-12T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-03-12T00:00:00-05:00","dateModified":"2020-03-12T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html"},"description":"summary","@type":"BlogPosting","url":"https://jerofad.github.io/blogs/2020/03/12/GMM-Tutorial.html","headline":"Title","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://jerofad.github.io/blogs/feed.xml" title="Jeremiah O. Fadugba" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blogs/">Jeremiah O. Fadugba</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blogs/about/">About Me</a><a class="page-link" href="/blogs/search/">Search</a><a class="page-link" href="/blogs/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="page-description">summary</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-12T00:00:00-05:00" itemprop="datePublished">
        Mar 12, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/jerofad/blogs/tree/master/_notebooks/2020-03-12-GMM-Tutorial.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blogs/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jerofad/blogs/master?filepath=_notebooks%2F2020-03-12-GMM-Tutorial.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blogs/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jerofad/blogs/blob/master/_notebooks/2020-03-12-GMM-Tutorial.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blogs/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-12-GMM-Tutorial.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Quick-Introduction-to-Gaussian-Mixture-Model">Quick Introduction to Gaussian Mixture Model<a class="anchor-link" href="#Quick-Introduction-to-Gaussian-Mixture-Model"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In density estimation, we represent the data compactly using a density from a parametric family like Gaussian distribution or beta distribution.
In using a Gaussian distribution for densty modelling, we seek to find the mean and variances of that represents such data compactly. Point estimation like Maximum Likelihood Estimation (MLE) or Maximum A posterior (MAP) can be used to find such mean and variance.</p>
<p>Most of the time, single model do fail in expressibility. In other words there is limitation in a modelling the data well. So we consider a mixture of such models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mixture-Models">Mixture Models<a class="anchor-link" href="#Mixture-Models"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A mixture model is used to describe a distribution $P(x)$ by a convex combination of K base distributions. I.e we seek a number, K, model distributions that are combined with weights. Which can be represented mathematically below as</p>
\begin{align*}
p(x) = \sum_{k=1}^{K}\pi_kP_k(x)
\end{align*}<p>where $\pi_k$ represents the weights and with the condition that 
\begin{align*}
0 \leq \pi_k \leq 1 \space ,  \space \sum_{k=1}^{K} \pi_k = 1
\end{align*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assuming the models are Gaussian, then we would be resulting into a Gaussian Mixture Model (GMM) which would be the focus of the tutorial. Other distributions that has a "name" could one way or the other be combined to have a mixture model examples are; Beta distribution, Gamma distribution and so on. \newline
Now our Gaussian Mixture Model would now be written mathematically as;
\begin{align*}
p(x) = \sum_{k=1}^{K}\pi_k \mathcal{N}(x|\mu_k, \Sigma_k)
\end{align*}</p>
<p>From above equation, we discover that our GMM now has 3 different parameters and they are $\theta = \{\pi_k, \mu_k, \Sigma_k\}$. so what we need to do now is to find a closed form solution for the parameter $\theta$ using the MLE and MAP. Just for heads up, we really cannot find a closed form solution, but we would see why we can't get such a closed form solution and then discuss way around to find the parameter.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So given our data $X = \{ x_1, \dots, x_N\}$ and parameter $\theta$, we would have a likelihood as shown below:
\begin{align*}
P(X|\theta) = \prod_{n=1}^{N}p(x_n|\theta)
\end{align*}
Assume our data is identically independently distributed (iid) then we would have a factorized likelihood as follows
\begin{align*}
P(X|\theta) =\prod_{n=1}^{N} \sum_{k=1}^{K}\pi_k \mathcal{N}(x_n|\mu_k, \Sigma_k)
\end{align*}
So taking the logarithm of the likelihood as we always do in MLE, our resulting equation becomes:
\begin{align*}
\log P(X|\theta) =\sum_{n=1}^{N} \log \sum_{k=1}^{K}\pi_k \mathcal{N}(x_n|\mu_k, \Sigma_k)
\end{align*}
Take a look at the last equation and find out how we could proceed analytically. We discovered that the logarithm function can't "enter" the sum. But if our K =1, its possible to move from there, but since we have multiple k's, we can not find a closed form solution. So how do we proceed to get the parameters $\theta$, we turn to an iterative scheme in finding the good parameters and Expectation Maximization (EM) algorithm is here for the bail.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A necessary condition for getting local optimum is that the derivative of the log likelihood with respect to each parameters must be zero.  See the reference if you're interested in the detailed derivation of the maths behind it. Here I am just going to state the formula and we proceed.
After derivation, we arrive at what we call responsibility which is closely related to the likelihood as follows:
\begin{align*}
r_{nk} = \frac{\pi_k \mathcal{N}(x_n|\mu_k, \Sigma_k)}{\sum_{k=1}^{K}\pi_k \mathcal{N}(x_n|\mu_k, \Sigma_k)}
\end{align*}</p>
<p>An important check is that our responsibility must sum up to 1 across each data-points i.e 
$\sum_{k=1}^{K}r_{nk}= 1$</p>
<p>Hence, $r_{nk}$ distributes a probability mass across the K components. The next line of action is to update the means and covariance matrix of each of the components using the responsibility $r_{nk}$ and the updated parameters are: 
\begin{align*}
\boldsymbol\mu_k^\text{new} &amp;= \frac{\sum_{n = 1}^Nr_{nk}\boldsymbol x_n}{\sum_{n =1}^N r_{nk}}\,,\\
\boldsymbol\Sigma_k^\text{new}&amp;= \frac{1}{N_k}\sum_{n=1}^Nr_{nk}(\boldsymbol x_n-\boldsymbol\mu_k)(\boldsymbol x_n-\boldsymbol\mu_k)^\top\,,\\
\pi_k^\text{new} &amp;= \frac{N_k}{N}
\end{align*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The math details of the formula can be checked out at the reference section.
 The EM Algorithm can be written as follows:</p>
<ul>
<li>Choose initial values for $ \mu_k$, $\Sigma_k$, $\pi_k $</li>
<li>Evaluate the responsibility $r_{nk}$</li>
<li>Use the updated  $r_{nk}$ to update the $\{\pi_k, \mu_k, \Sigma_k\}$ </li>
</ul>
<p>If convergence condition is not met, repeat step 2 and 3 \</p>
<p>And so we are done with some theoretical description of Gaussian Mixture Model.</p>
<p>Let us see how to approach this via coding them up. We would approach this as a modelling approach and give reasons for some of the choices</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AffinityPropagation</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Ellipse</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data">Data<a class="anchor-link" href="#Data"> </a></h3><p>The data we are using is a geo-location data gathered from 30 students in various countries from Africa. You are given a two-dimensional dataset of about 30 geolocations (latitude/longitude) of birthplaces. The task here is to use GMM to model the data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">6.14512</span><span class="p">,</span> <span class="mf">7.14512</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.5582</span><span class="p">,</span> <span class="mf">3.3466</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.4646</span><span class="p">,</span> <span class="mf">10.0631</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.1372</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.0754</span><span class="p">],</span> <span class="p">[</span><span class="mf">35.6177</span><span class="p">,</span> <span class="mf">5.0999</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2774244</span><span class="p">,</span> <span class="mf">32.4783873</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">5.56508</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1601</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.65611</span><span class="p">,</span> <span class="mf">32.48492</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.7074454</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.474397</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.7765117</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.3226387</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.03106</span><span class="p">,</span> <span class="mf">9.73532</span><span class="p">],</span> <span class="p">[</span><span class="mf">24.713139</span><span class="p">,</span> <span class="mf">46.622186</span><span class="p">],</span> 
        <span class="p">[</span><span class="mf">15.65792</span><span class="p">,</span> <span class="mf">32.46231</span><span class="p">],</span> <span class="p">[</span><span class="mf">52.4378</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.76</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.441518</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.268147</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.1058</span><span class="p">,</span> <span class="mf">9.7529</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.1345</span><span class="p">,</span> <span class="mf">14.7117</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.56</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2057</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.8848</span><span class="p">,</span> <span class="mf">29.7772</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.9389</span><span class="p">,</span> <span class="mf">9.7437</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.4431</span><span class="p">,</span> <span class="mf">3.9022</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.8797</span><span class="p">,</span> <span class="mf">2.7675</span><span class="p">],</span> <span class="p">[</span><span class="mf">21.54238</span><span class="p">,</span> <span class="mf">39.19797</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.633</span><span class="p">,</span> <span class="mf">38.783</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.6166</span><span class="p">,</span> <span class="mf">30.1166</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2408</span><span class="p">,</span> <span class="mf">32.5523</span><span class="p">],</span> 
        <span class="p">[</span><span class="mf">15.79255</span><span class="p">,</span> <span class="mf">32.52596</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.531475</span><span class="p">,</span> <span class="mf">3.32405</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.9535</span><span class="p">,</span> <span class="mf">9.9382</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.9008438</span><span class="p">,</span> <span class="mf">36.2843654</span><span class="p">]]</span> 
<span class="c1"># convert our list to an ndarray </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h1><p>In Model selection, we use the idea from Occam’s razor technique that says we should favour simple model over complicated ones when we have fewer datasets. One specific challenge in our case here is that the data points are few so it would be difficult getting a good density estimation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>My approach in modelling this data is to first use Affinity Propagation which is an algorithm that ”guess” the number of suitable clusters for the data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">af</span> <span class="o">=</span> <span class="n">AffinityPropagation</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">cluster_centers_indices</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="n">cluster_centers_indices_</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="n">labels_</span>

<span class="n">n_clusters_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster_centers_indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_clusters_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This algorithm outputs 5 clusters as the optimal number of clusters.</p>
<p>The first thoughts that comes to mind in modelling a datasets like this is to consider using K-means clustering.</p>
<p>Let us use KMeans algorithm from scikit learn and use it as a model for data to figure out what is going on here.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_kmeans</span><span class="p">(</span><span class="n">kmeans</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rseed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># plot the input data</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span> <span class="ow">or</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># plot the representation of the KMeans model</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
    <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">center</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">center</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centers</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">radii</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#CCCCCC&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plot_kmeans</span><span class="p">(</span><span class="n">kmeans</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using K-Means is not a bad idea but then as seen above, it makes a hard clustering on the data and also the shape of the clusters is not most times intuitive. Als, we can see that some data points lies on the boundary of the shape of the clusters.</p>
<p>We consider a generalization of K- means which is the Gaussian Mixture Model (GMM).</p>
<p>Next is to try and also bring into account the variance represented in the
clustering which GMM takes care of. In GMM we also do have to specify the number of components of Gaussian models to mix. In this case, I decided to use 4 clusters just a ±1 to the number of clusters we have before.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Modelling-with-GMM">Modelling with GMM<a class="anchor-link" href="#Modelling-with-GMM"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first step in our modelling is to initialize our parameters which are the means, covariance and responsibility (prior). $ \mu_k$, $\Sigma_k$, $\pi_k $</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Number of mixture models</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
<span class="n">covs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
<span class="n">priors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">initialCovariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="c1">#the initial mean for each gaussian is chosen randomly</span>
    <span class="n">covs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">initialCovariance</span> <span class="c1">#the initial covariance of each cluster is the covariance of the data</span>
    <span class="n">priors</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">K</span>  <span class="c1">#the initial priors are uniformly distributed.</span>

<span class="n">initial_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mu&quot;</span><span class="p">:</span> <span class="n">means</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span><span class="n">covs</span><span class="p">,</span> <span class="s2">&quot;pi&quot;</span><span class="p">:</span><span class="n">priors</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The second step in the algorithm is to evaluate the responsibility $r_{nk}$ which is the E-step</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-show</span>
<span class="k">def</span> <span class="nf">E_step</span><span class="p">(</span> <span class="n">mu</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">pi</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the E step of the EM algorithm.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      mu -- component means, K x D array</span>
<span class="sd">      S -- component covariances, K x D x D array</span>
<span class="sd">      pi -- component weights, K x 1 array</span>

<span class="sd">    Returns:</span>
<span class="sd">      r_new -- updated component responsabilities, N x K array</span>
<span class="sd">    &quot;&quot;&quot;</span>
  
    <span class="c1"># Assert that all arguments have the right shape</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span>  <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pi</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">r_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
    <span class="c1"># Here we implement the E step and return updated responsabilities</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">r_new</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">r_new</span> <span class="o">=</span> <span class="n">r_new</span> <span class="o">/</span> <span class="p">(</span><span class="n">r_new</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">r_new</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">r_new</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The third step, M-step, uses the updated  $r_{nk}$ from E-step is to update the $\{\pi_k, \mu_k, \Sigma_k\}$  given below as</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-show</span>
<span class="k">def</span> <span class="nf">M_step</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the M step of the EM algorithm.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      mu -- previous component means, K x D array</span>
<span class="sd">      r -- previous component responsabilities,  N x K array</span>

<span class="sd">    Returns:</span>
<span class="sd">      mu_new -- updated component means, K x D array</span>
<span class="sd">      S_new -- updated component covariances, K x D x D array</span>
<span class="sd">      pi_new -- updated component weights, K x 1 array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span>\
           <span class="n">r</span><span class="o">.</span><span class="n">shape</span>  <span class="o">==</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
    <span class="n">mu_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span><span class="n">D</span><span class="p">))</span>
    <span class="n">S_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
    <span class="n">pi_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Task 2: implement the M step and return updated mixture parameters</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="n">pi_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">N</span>   <span class="c1">#update priors</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span> <span class="c1">#update means</span>
            <span class="n">mu_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">mu_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span> <span class="c1">#update means</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">mu_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">S_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">vec</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="c1">#update covs</span>

        <span class="n">S_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">mu_new</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">S_new</span><span class="o">.</span><span class="n">shape</span>  <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pi_new</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">mu_new</span><span class="p">,</span> <span class="n">S_new</span><span class="p">,</span> <span class="n">pi_new</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next and final step is to implement the EM algorithm that helps us to train our Gaussian mixture model.</p>
<p>The training step basically involves running our E and M steps itereatively until a stopping criteria is reached. Our stopping criteria is dependent on the log-likelihood estimate considering that "every step in the EM algorithm increases the log-likelihood function"</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">initial_params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fit a Gaussian Mixture Model (GMM) to the data in matrix X.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      initial_params -- dictionary with fields &#39;mu&#39;, &#39;S&#39;, &#39;pi&#39; and &#39;K&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">      mu -- component means, K x D array</span>
<span class="sd">      S -- component covariances, K x D x D array</span>
<span class="sd">      pi -- component weights, K x 1 array</span>
<span class="sd">      r -- component responsabilities, N x K array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Assert that initial_params has all the necessary fields</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="n">k</span> <span class="ow">in</span> <span class="n">initial_params</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;pi&#39;</span><span class="p">]]))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">initial_params</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">initial_params</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">initial_params</span><span class="p">[</span><span class="s2">&quot;pi&quot;</span><span class="p">]</span>
    <span class="c1"># Task 3: implement the EM loop to train the GMM</span>
    <span class="n">num_Iter</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">log_likelihoods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">loglik_old</span> <span class="o">=</span><span class="mi">0</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_Iter</span><span class="p">:</span>
        <span class="c1"># Run The E -step</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">E_step</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
        
        <span class="c1"># Run M-Step to update the parameters.</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">M_step</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

        <span class="n">loglikelihood</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
                <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">mu</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">loglikelihood</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">log_likelihoods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loglikelihood</span><span class="p">)</span>
        
        <span class="c1"># check for convergence</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_likelihoods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loglikelihood</span> <span class="o">-</span> <span class="n">log_likelihoods</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Likelihood has converged !!&quot;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span>  <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> <span class="ow">and</span>
           <span class="n">pi</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">shape</span>  <span class="o">==</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">r</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have writtent the code all that we need to find our parameters for the GMM, we can now train our model.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-show</span>
<span class="n">mu_</span><span class="p">,</span> <span class="n">S_</span><span class="p">,</span> <span class="n">pi_</span><span class="p">,</span> <span class="n">r_</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">initial_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Likelihood has converged !!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now visualize our model by running GMM on our data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_ellipse</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">nstd</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">eigsorted</span><span class="p">(</span><span class="n">cov</span><span class="p">):</span>
            <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">order</span><span class="p">],</span> <span class="n">vecs</span><span class="p">[:,</span><span class="n">order</span><span class="p">]</span>
    
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    
        <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigsorted</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">*</span><span class="n">vecs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    
        <span class="c1"># Width and height are &quot;full&quot; widths, not radius</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nstd</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>
        <span class="n">ellip</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ellip</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ellip</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">):</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="c1"># number of clusters</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;m*&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
      <span class="n">plot_ellipse</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">cov</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">k</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">mu_</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">S_</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((30, 2), (2, 2), (2, 2, 2))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="c1"># fig.add_subplot(121)</span>
<span class="n">show</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu_</span><span class="p">,</span> <span class="n">S_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we observe that a data-point could belong to one or more clusters (soft clustering). Also we could see that in GMM model, the shape is different to the clustering. If we decide to increase the number of clusters to 5, then we would be having overlap datapoints. That is a data point could fall within two clusters.
Hence, we have been able to provide a better modelling for our data.</p>
<p>But then model selection comes to play. How do we know the best number of three components of gaussian mixture to use. We use the Bayesian Information Criterion (BIC) to determine the optimal number of components. The figure below shows the result of using BIC on our Gaussian Mixture Models.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/blogs/2020/03/12/GMM-Tutorial.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blogs/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blogs/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blogs/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jerofad" title="jerofad"><svg class="svg-icon grey"><use xlink:href="/blogs/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/jerofad" title="jerofad"><svg class="svg-icon grey"><use xlink:href="/blogs/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
